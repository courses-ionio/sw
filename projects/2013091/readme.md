Δυναμική Δημιουργία Οδηγού Σπουδών
-----------------------------------------------------------------------------------------------------------------------------------
 Ονοματεπώνυμο: Βασιλειάδης Θωμάς
 
 Αριθμός Μητρώου: Π2013091
 
 Σύνοψη
-----------------------------------------------------------------------------------------------------------------------------------
Το συγκεκριμένο έγγραφο αποτελεί την τελική αναφορά του πρώτου παραδοτέου της εργασίας του Βασιλειάδη Θωμά(Π2013091) στα πλαίσια του μαθήματος Τεχνολογία Λογισμικού του διδάσκοντα κ. Χωριανόπουλου.

Σκοπός της εργασίας είναι να γίνει συνεργατική επεξεργασία του αρχικού αρχείου και οργάνωση του σε επιμέρους αρχεία, έτσι ώστε να είναι εύκολη η μελλοντική επεξεργασία και ταυτόχρονα η αυτόματη σύνθεση τους στο τελικό αρχείο σε μορφή PDF. Επίσης, σκοπός αυτής της εργασίας είναι η εναλλακτική ροή εργασίας και διαφορετικό σύστημα παραγωγής PDF, (πχ LaTeX), mobile app (π.χ., PWA), καθώς και η αυτόματη δημιουργία ενημερωμένου οδηγού σε μορφή PDF για κάθε αλλαγή στα πηγαία αρχεία με χρήση CI (π.χ., Travis-CI) και με οργάνωση δικτυακής υπηρεσίας.

Μέθοδος και τεχνικές ανάπτυξης
-----------------------------------------------------------------------------------------------------------------------------------

Έγινε η εγκατάσταση των εργαλείων τοπικά (pandoc, latex). Όσον αναφορά το weasyprint, απέτυχα να το εγκαταστήσω λόγω compatibility με python2.7 παρόλο που έχω και python3. Κάνοντας μια έρευνα βρήκα ότι το wkhtmltopdf είναι εξίσου χρήσιμο και θα με βοηθήσει στην δουλειά που θέλω να κάνω.

- [Δοκιμαστικό PDF](https://github.com/ThomasVasileiadis/study-guide/blob/develop/dokimastiko.pdf)

- [Τελικές οθόνες εγκατάστασης](https://github.com/ThomasVasileiadis/study-guide/blob/develop/egkatastash.png)

- [Αποθετήριο του κώδικα](https://github.com/ThomasVasileiadis/study-guide)


Αρχικά, δημιουργήθηκαν [8 αρχεία](https://github.com/ThomasVasileiadis/study-guide/tree/master/undergraduate-studies1718) στα οποία τακτοποιούνται τα 8 εξάμηνα με τα μαθήματα που περιέχονται σε αυτά και τις πληροφορίες αυτών (ECTS για κάθε μάθημα, Ώρες, Εργαστήρια-Φροντιστήρια, Κατευθύνσεις), καθώς επίσης δημιουργήθηκαν πινακάκια για στοίχιση των δεδομένων για εύκολη ανάγνωση. Τα δεδομένα από τα αρχεία πάρθηκαν, όπως αναφέρθηκε στην εκφώνηση, από την [τρέχουσα έκδοση οδηγού σπουδών](https://github.com/ioniodi/study-guide/blob/master/legacy/odt1718/SG1718.md), και πριν αυτό, έγινε έλεγχος για να μην επιλεχθούν τα ίδια αρχεία με αυτά που έχουν ήδη επιλεχτεί σε [ανοιχτά](https://github.com/ioniodi/study-guide/pulls) και [κλειστά](https://github.com/ioniodi/study-guide/pulls?q=is%3Apr+is%3Aclosed) αιτήματα.

Στην συνέχεια, έγινε τροποποίηση στο αρχείο [style.css](https://github.com/ThomasVasileiadis/study-guide/blob/master/legacy/odt1718/style.css) και άλλαξα χρώματα στο background, στα headers και στα γράμματα της σελίδας.

Ακόμη, για τη σελίδα χωρίς εικόνες, τακτοποίησα και διόρθωσα όλη τη σελίδα και την ανέβασα στο [forked-repository](https://github.com/ThomasVasileiadis/study-guide/tree/master/legacy/odt1718) με όνομα [html2markdown.md](https://github.com/ThomasVasileiadis/study-guide/blob/master/legacy/odt1718/html2markdown.md) (δημιούργησα το html αρχείο, το επεξεργάστηκα και μετά το μετέτρεψα σε markdown μέσω του pandoc).

Συνεχίζοντας, εφαρμόστηκε continuous intergration στο project με την χρήση του [Travis-CI](https://travis-ci.org). Για αυτό το λόγο δημιουργήθηκε ένα αρχείο [.travis.yml](https://github.com/ThomasVasileiadis/study-guide/blob/develop/Screenshot_1.png) το οποίο περιέχει όλα τα configurations και όλες τις εντολές που χρειάζεται να τρέξει το Travis για να παράγει το .html αρχείο και έπειτα από το .html να παράγει το .pdf αρχείο το οποίο περιέχει την σελίδα της σχολής.

Το .travis.yml αρχείο φαίνεται παρακάτω:

![configuration file](https://github.com/ThomasVasileiadis/study-guide/blob/develop/Screenshot_1.png)

Με αυτό τον τρόπο, κάθε φορά που γίνεται μια αλλαγή στο project, το Travis-CI θα αναγνωρίσει την αλλαγή και θα ξανακάνει build, και έτσι όλη η προαναφερθείσα διαδικασία θα πραγματοποιείται αυτόματα.

Κάνωντας μια περιληπτική αναφορά του τι περιέχει το script του configuration file. Αρχικά, λέμε στο virtual enviroment ότι θα υποστηρίζει τις γλώσσες bash, php, και python. Έπειτα, πρωτού ξεκινήσει το script χρειαζόμαστε από το μηχάνημα να μας έχει εγκατεστημένα κάποια πράγματα (εξού και "before_script"). Θέλουμε να γίνεται εγκατάσταση του pandoc, της python3-pip, του latex και του wkhtmltopdf μαζί με δύο συνοδευτικά εργαλεία που διευκολύνουν την διαδικασία παραγωγής του pdf αρχείου (xvfb και libfontconfig). Ακόμη ήταν απαραίτητη και η εγκατάσταση ενός compiler σε γλώσσα C (sudo apt install gcc).

Στην συνέχεια, όταν ξεκινάει το script, αρχικά ελέγχω αν τα προγράμματα εγκαταστάθηκαν με επιτυχία ελέγχοντας τις εκδόσεις τους, μέθοδος η οποία με βοήθισε να εντοπίζω καλύτερα που έγινε λάθος στο script μιας και χρειάστηκε αρκετές επαναλήψεις πριν το script ήταν σωστό. Έπειτα, πηγαίνω στο σωστό directory και παράγω το html και pdf αρχείο.

Επίσης έγινε επεξεργασία στο script [md2html2pdf.sh](https://github.com/ThomasVasileiadis/study-guide/blob/develop/legacy/odt1718/md2html2pdf.sh) για να μπορεί να παραχθεί το pdf με επιτυχία με τη χρήση του εργαλείου wkhtmltopdf αντί του weasyprint. 

Λίγα λόγια για το εργαλείο wkhtmltopdf. Το wkhtmltopdf είναι ένα εργαλείο γραμμής εντολών ανοιχτού κώδικα (open source) για την απόδοση HTML σε PDF και σε μορφές εικόνας χρησιμοποιώντας το rendering engine του Qt WebKit. Όλα αυτά τρέχουν εντελώς headless και δεν χρειάζεται display ή display service.

Αποτελέσματα - Συμπεράσματα
---------------------------------------------------------------------------------------------------------------------------------------

Έτσι, με βάση όσα αναφέρθηκαν προηγουμένως για το continuous intergration, ας πάμε να δούμε τα αποτελέσματα όλης αυτής της διαδικασίας. Παρακάτω θα δοθούν ενδεικτικές οθόνες και θα γίνει επεξήγηση και ανάλυση των αποτελεσμάτων.

Όπως βλέπουμε εδώ, το Travis-CI μας ενημερώνει ότι το τελευταίο build που έκανε (με βάση το .travis.yml αρχείο που του δώσαμε) ήταν επιτυχής. 

![screenshot](https://github.com/ThomasVasileiadis/study-guide/blob/develop/Screenshot_2.png)

Συνεχίζοντας, ας δούμε ολη την διαδικασία του build που πραγματοποίησε το Travis-CI.

![screenshot](https://github.com/ThomasVasileiadis/study-guide/blob/develop/Screenshot_3.png)

Εδώ βλέπουμε ότι ό,τι γράψαμε στο .travis.yml αρχείο για να γίνει εγκατάσταση, ολοκληρώθηκε με επιτυχία. Ενδιάμεσα από κάθε εγκατάσταση έχω βάλει να κάνει ένα update τα repositories του με sudo apt-get update, για να μην υπάρξει κάποιο conflict με packages.

Συνεχίζοντας, ας δούμε τι έγινε στην διαδικασία εκτέλεσης του main script.

![screenshot](https://github.com/ThomasVasileiadis/study-guide/blob/develop/Screenshot_4.png)

Όπως φαίνεται, το Travis-CI ψάχνει για τους φακέλους, κατευθείνεται στον φάκελο που περιέχει το .sh script για να τρέξει, και το τρέχει με επιτυχία, άρα παράγεται σωστά και αυτόματα το pdf αρχείο.

Συμπερασματικά, το Travis-CI είναι ένα πολύ δυνατό εργαλείο για continuous intergration, το οποίο διευκολύνει τον χρήστη με αυτοματοποιημένες διαδικασίες.

Βιβλιογραφία
----------------------------------------------------------------------------------------------------------------------------------------

[cv-boilerplate](https://github.com/mrzool/cv-boilerplate)

[pandoc-project-boilerplate](https://github.com/juh2/pandoc-project-boilerplate)
